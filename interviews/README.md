> # –ò–Ω—Ç–µ—Ä–≤—å—é
>
> –ü–æ–¥–±–æ—Ä–∫–∞ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –∑–∞–¥–∞—á, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ø–∞–¥–∞–ª–∏—Å—å –º–Ω–µ –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è—Ö.

## –ü–æ–∏—Å–∫ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞

–î–∞–Ω –º–∞—Å—Å–∏–≤ –ø–∞—Ä–Ω—ã—Ö —á–∏—Å–µ–ª, –Ω–∞–ø—Ä–∏–º–µ—Ä, `[1, 3, 5, 3, 5, 1]`, `[6, 2, 2, 4, 6, 4]`.
–í –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ —Ç–∞–∫–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —á–∏—Å–ª–æ, –æ—Ç–ª–∏—á–Ω–æ–µ –æ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã—Ö:
- –¥–ª—è `[1, 3, 5, 3, 5, 1]` -> `[1, 3, 5, 7, 3, 5, 1]` —Ç–∞–∫–æ–µ —á–∏—Å–ª–æ 7
- –¥–ª—è `[6, 2, 2, 4, 6, 4]` -> `[6, 2, 2, 4, 1, 6, 4]` —Ç–∞–∫–æ–µ —á–∏—Å–ª–æ 1

–ó–∞–¥–∞—á–∞ –Ω–∞–π—Ç–∏ —ç—Ç–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –∑–∞ O(n) –∏ O(1) –ø–æ –ø–∞–º—è—Ç–∏.

<details><summary>üëÄ</summary><p role="separator"></p>

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ O(n) –∏—Å–∫–ª—é—á–∞–µ—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã
—Å–¥–µ–ª–∞—Ç—å in-place, —á—Ç–æ–±—ã –≤–ø–∏—Å–∞—Ç—å—Å—è –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ. –û–Ω–æ –∂–µ –Ω–µ –ø–æ–∑–≤–æ–ª–∏—Ç
–ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º –ø–æ –∫–ª—é—á—É, —Ç–∏–ø–∞ hash table, —Ç.–∫.
–Ω–∞ –µ—ë —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å.

–ê–∫—Ü–µ–Ω—Ç –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å –Ω–∞ —Ç–æ–º, —á—Ç–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —á–∏—Å–µ–ª –≤ –º–Ω–æ–∂–µ—Å—Ç–≤–µ —á—ë—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ.
</details>

## –î–≤—É—Å–≤—è–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫

–ù—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Å–≤—è–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ–º –ø–∞–º—è—Ç–∏.

<details><summary>üëÄ</summary><p role="separator"></p>

[XOR linked list](https://en.wikipedia.org/wiki/XOR_linked_list).
</details>

## –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏

–î–∞–Ω –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ –∏–∑ n —á–∏—Å–µ–ª, k –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –±—ã–ª–∏ –∑–∞–º–µ–Ω–µ–Ω—ã –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º
–æ–±—Ä–∞–∑–æ–º. –ù–∞–ø—Ä–∏–º–µ—Ä,
- `[3, 6, 7, 10, 11, 15]` -> `[3, 6, 4, 10, 14, 15]`
- `[2, 4, 5, 23, 41, 60]` -> `[10, 4, 5, 23, 9, 60]`

–ó–∞–¥–∞—á–∞ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–∫–æ–π –º–∞—Å—Å–∏–≤ –º–µ–Ω—å—à–µ —á–µ–º –∑–∞ n*log(n).

<details><summary>üëÄ</summary><p role="separator"></p>

–î–ª—è —Ä–µ—à–µ–Ω–∏—è —ç—Ç–æ–π –∑–∞–¥–∞—á–∏ –Ω—É–∂–Ω–æ –≤—Å–ø–æ–º–Ω–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º merge sort –∏ –ø–µ—Ä–µ–æ—Å–º—ã—Å–ª–∏—Ç—å
–µ–≥–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∑–Ω–∞–Ω–∏—è –æ —Ç–æ–º, —á—Ç–æ –∏—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤ —É–∂–µ –±—ã–ª –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω.
</details>

## Go –∏ CPU

### [Branch predictor](https://en.wikipedia.org/wiki/Branch_predictor)

–ù—É–∂–Ω–æ –æ–±—ä—è—Å–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```go
package main

import (
	"fmt"
	"math/rand"
	"sort"
	"time"
)

func main() {
	arr := make([]int, 10_000_000)
	for i := 0; i < 10_000_000; i++ {
		arr[i] = i
	}
	calculate(arr)

	rand.Seed(time.Now().UnixNano())
	rand.Shuffle(len(arr), func(i, j int) { arr[i], arr[j] = arr[j], arr[i] })
	calculate(arr)

	sort.Ints(arr)
	calculate(arr)
}

func calculate(arr []int) {
	t := time.Now()
	s := 0
	for _, r := range arr {
		if r < 100_000/2 {
			s += r * 2
		} else {
			s += r
		}
	}
	fmt.Println("duration:", time.Since(t).Nanoseconds())
}

// duration: 3226301
// duration: 3738684 <- please explain
// duration: 3244984
```

### [CPU cache](https://en.wikipedia.org/wiki/CPU_cache)

–ù—É–∂–Ω–æ –æ–±—ä—è—Å–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```go
package main

import (
	"fmt"
	"math/rand"
	"sort"
	"time"
)

func main() {
	arr := make([]*int, 1_000_000)
	for i := 0; i < 1_000_000; i++ {
		i := i
		arr[i] = &i
	}
	calculate(arr)

	rand.Seed(time.Now().UnixNano())
	rand.Shuffle(len(arr), func(i, j int) { arr[i], arr[j] = arr[j], arr[i] })
	calculate(arr)

	sort.Slice(arr, func(i, j int) bool { return *arr[i] < *arr[j] })
	calculate(arr)
}

func calculate(arr []*int) {
	t := time.Now()
	s := 0
	for _, r := range arr {
		s += *r
	}
	fmt.Println("duration:", time.Since(t).Nanoseconds())
}

// duration: 1369079
// duration: 14710353 <- please explain
// duration: 1050656
```
